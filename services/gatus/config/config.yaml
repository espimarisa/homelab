---
# Default alert options.
x-defaults-alerts: &defaults-alerts
  - type: discord # Use Discord by default.
    send-on-resolved: true

# Default HTTP options.
x-defaults-http: &defaults-http
  alerts: *defaults-alerts
  interval: 5m
  conditions:
    - "[CERTIFICATE_EXPIRATION] > 240h" # Ensures certificates are up-to-date.
    - "[RESPONSE_TIME] < 2000" # External services shouldn't take more than 2s to resolve.
    - "[STATUS] == 200" # 200 will be an OK

# Default container options.
x-defaults-container: &defaults-container
  alerts: *defaults-alerts
  interval: 5m
  conditions:
    - "[BODY].State.Health.Status != unhealthy" # Not the most accurate check.
    - "[RESPONSE_TIME] < 10" # Containers should always be within ~10ms.
    - "[STATUS] == 200" # 200 will be an OK
  ui:
    hide-hostname: true # no reason to show container hostnames

# Alerting configuration.
alerting:
  discord: # Send to a Discord webhook by default.
    title: "ðŸš¨ Status Update"
    webhook-url: "${GATUS_DISCORD_WEBHOOK_URL}"

# Database configuration.
storage:
  type: postgres # Use PostgreSQL.
  path: "postgres://postgres:${GATUS_DB_PASSWORD}@gatus-db:5432/postgres?sslmode=disable" # Connect to PostgreSQL.

# UI configuration.
ui:
  default-sort-by: group # Sort by group automatically.
  description: "${GATUS_DESCRIPTION}" # Sets the page description.
  header: ${GATUS_HEADER} # Sets the header name.
  link: "/" # Fixes the header link.
  logo: "${GATUS_LOGO_URL}" # Sets the logo URL.
  title: ${GATUS_TITLE} # Sets the page title.

endpoints:
  ###########################################################################
  # Databases.                                                              #
  ###########################################################################

  # Autobrr DB.
  - name: Autobrr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/autobrr-db/json

  # Bazarr DB.
  - name: Bazarr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/bazarr-db/json

  # Gatus DB.
  - name: Gatus - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/gatus-db/json

  # Lidarr DB.
  - name: Lidarr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/lidarr-db/json

  # Prowlarr DB.
  - name: Prowlarr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/prowlarr-db/json

  # Radarr DB.
  - name: Radarr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/radarr-db/json

  # Sonarr DB.
  - name: Sonarr - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/sonarr-db/json

  # Vaultwarden DB.
  - name: Vaultwarden - PostgreSQL
    <<: *defaults-container
    group: Databases
    url: ${SOCKET_PROXY_URL}/vaultwarden-db/json

  ###########################################################################
  # Download clients.                                                       #
  ###########################################################################

  # Autobrr.
  - name: Autobrr
    <<: *defaults-container
    group: Downloads
    url: ${SOCKET_PROXY_URL}/autobrr/json

  # Gluetun.
  - name: Gluetun (VPN)
    <<: *defaults-container
    group: Downloads
    url: ${SOCKET_PROXY_URL}/gluetun/json

  # qBittorrent.
  - name: qBittorrent
    <<: *defaults-container
    group: Downloads
    url: ${SOCKET_PROXY_URL}/qbittorrent/json

  # slskd.
  - name: slskd
    <<: *defaults-container
    group: Downloads
    url: ${SOCKET_PROXY_URL}/slskd/json

  ###########################################################################
  # Infrastructure.                                                         #
  ###########################################################################

  # Caddy.
  - name: Caddy
    <<: *defaults-container
    group: Infrastructure
    url: ${SOCKET_PROXY_URL}/caddy/json

  # Socket Proxy.
  - name: Socket Proxy
    <<: *defaults-container
    group: Infrastructure
    url: ${SOCKET_PROXY_URL}/socket-proxy/json

  ###########################################################################
  # Media management.                                                       #
  ###########################################################################

  # Bazarr.
  - name: Bazarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/bazarr/json

  # Byparr.
  - name: Byparr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/byparr/json

  # Configarr.
  - name: Configarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/configarr/json

  # Lidarr.
  - name: Lidarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/lidarr/json

  # mam-ip-helper
  - name: MyAnonaMouse IP Helper
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/mam-ip-helper/json

  # Prowlarr.
  - name: Prowlarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/prowlarr/json

  # Radarr.
  - name: Radarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/radarr/json

  # Sonarr.
  - name: Sonarr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/sonarr/json

  # Unpackerr.
  - name: Unpackerr
    <<: *defaults-container
    group: Media Management
    url: ${SOCKET_PROXY_URL}/unpackerr/json

  ###########################################################################
  # Monitoring.                                                             #
  ###########################################################################

  # Beszel.
  - name: Beszel
    <<: *defaults-container
    group: Monitoring
    url: ${SOCKET_PROXY_URL}/beszel/json

  # Beszel Agent.
  - name: Beszel Agent
    <<: *defaults-container
    group: Monitoring
    url: ${SOCKET_PROXY_URL}/beszel-agent/json

  # Dozzle.
  - name: Dozzle
    <<: *defaults-container
    group: Monitoring
    url: ${SOCKET_PROXY_URL}/dozzle/json

  # Gatus.
  - name: Gatus
    <<: *defaults-container
    group: Monitoring
    url: ${SOCKET_PROXY_URL}/gatus/json

  ###########################################################################
  # Services.                                                               #
  ###########################################################################

  # Chhoto URL.
  - name: Chhoto URL
    <<: *defaults-http
    group: Services
    url: https://${CHHOTO_URL}

  # Jellyfin.
  - name: Jellyfin
    <<: *defaults-http
    group: Services
    url: https://${JELLYFIN_URL}/health

  # OpenCloud.
  - name: OpenCloud
    <<: *defaults-http
    group: Services
    url: https://${OPENCLOUD_URL}

  # The Lounge.
  - name: The Lounge
    <<: *defaults-http
    group: Services
    url: https://${THELOUNGE_URL}

  # Vaultwarden.
  - name: Vaultwarden
    <<: *defaults-http
    group: Services
    url: https://${VAULTWARDEN_URL}/alive

  ###########################################################################
  # Websites.                                                               #
  ###########################################################################

  # Quad9 (here for DNS resolving problemos).
  - name: Quad9 - HTTP
    <<: *defaults-http
    group: Websites
    url: https://quad9.net

  # Website.
  - name: Main Website - HTTP
    <<: *defaults-http
    group: Websites
    url: https://${DOMAIN}
