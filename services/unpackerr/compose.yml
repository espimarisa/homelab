services:
  ###########################################################################
  # Unpackerr: Auto-extract compressed downloads - https://unpackerr.zip   #
  ###########################################################################

  unpackerr:
    image: ghcr.io/unpackerr/unpackerr:0.14.5
    container_name: unpackerr
    env_file: ../../.env
    hostname: unpackerr
    read_only: true
    restart: unless-stopped
    user: ${PUID}:${PGID}
    environment:
      TZ: "${TZ}"
      UMASK: "${UMASK}"
      UN_LOG_FILE: "/downloads/unpackerr.log"
      UN_RADARR_0_API_KEY: "${RADARR_API_KEY}"
      UN_RADARR_0_URL: "http://radarr:7878"
      UN_SONARR_0_API_KEY: "${SONARR_API_KEY}"
      UN_SONARR_0_URL: "http://sonarr:8989"
    networks:
      - gluetun
    tmpfs:
      - "/tmp:uid=${PUID},gid=${PGID}"
    volumes:
      - downloads:/downloads
    cap_add:
      - CHOWN
    cap_drop:
      - ALL
    deploy:
      resources:
        limits:
          cpus: "2.0"
          memory: 512M
        reservations:
          cpus: "0.10"
          memory: 128M
    security_opt:
      - no-new-privileges:true
